# JSP 20211014 TIL

JSP 수업을 나가기 전 기본적인 웹에 대한 기초적 이론을 공부하였다.

## 웹 프로그래밍

웹 프로그래밍은 웹 어플리케이션을 만드는 행위를 말한다. 여기서 웹 어플리케이션은 웹을 기반으로 동작하는 프로그램을 말한다.
그렇다면 웹을 무엇일까? 인터넷 서비스의 형태를 웹이라고 정의한다. 인터넷은 하나 이상의 네트워크가 연결되어 있는 형태를 인터넷이라 칭한다.
네트워크를 연결하기위해서는 웹 서버가 필요한데, 각 클라이언트에게 컨텐츠(HTML, CSS, JS) 서비스를 제공하기위해서 필요하다.

웹 서버 중에서 Web Application Server(WAS)가 있는데 DB조회나 어떤 로직을 처리해야하는 동적인 컨텐츠를 제공하는 서버를 말한다.
클라이언트는 네트워크로 서버에 접속한 후 서버로부터 서비스를 제공받는 컴퓨터를 뜻한다.

HTTP 프로토콜은 Hyper Text Transfer Protocol의 약자로 www 서비스를 제공하는 통신 규약을 말한다. HTML을 비롯하여 이미지, 동영상,
XML 문서 등 다양한 데이터를 주고받을 때 사용하는 일종의 규칙을 뜻한다. 웹서버와 클라이언트는 HTTP 프로토콜을 통해 정보를 주고 받는다.

Dynamic Web Programming은 동적 웹 프로그래밍으로, 클라이언트의 요청이 있을 때마다 DB에 접근하여 실시간 정보를 클라이언트게 제공하는 기능을 처리하는 방식을 말한다.

웹 프로그래밍은 CGI 방식과 어플리케이션 서버 방식이 있다.
CGI 방식은 클라이언트의 요청에 독립된 프로세스를 생성하기 때문에 점유하는 메모리가 많아져 시스템의 부하를 주게된다.
요청이 발생할 떄마다 매 번 메모리에 프로그램을 로딩하기 때문에 동시에 여러 명의 접속자가 접속하여 프로그램을 실행하는 경우
서버의 메모리도 증가하게 된다. 주로 C++ 언어에서 사용되어진다.

어플리케이션 서버 방식은 동시에 여러 명의 접속자가 동일한 프로그램의 처리를 요청하여도 한 개에 해당하는 메모리만 사용하는
스레드 방식으로 이루어져 있는데, CGI 방식에 비해 메모리 사용량이 적다. 스레드 방식은 한꺼번에 많은 요청이 들어왔을 경우에
동시에 요청들을 처리하되, DB에 접근할 때는 하나의 스레드만 접근하도록 하여 전달되는 데이터에 문제점이 없도록 하는 것을 말한다.(Thread Pool)
주로 ASP, PHP, JSP에서 사용되어진다.

## Servlet

Servlet은 서버 쪽에서 실행되면서 클라이언트의 요청에 따라 동적으로 서비스를 제공하는 자바 클래스이다.
자바로 작성되어져 있어 자바가 가지고 있는 특징을 모두 가지고 있다. 서블릿은 서버에서 실행되다가 웹 브라우저에서 요청하면
해당기능을 수행한 다음 웹 브라우저에게 결과를 전송한다. 서버에서 실행되기 때문에 보안과 관련도니 기능도 안전하게 수행할 수 있다.

## Servlet Life Cycle(서블릿 생명 주기)

- init() : 단 한번만 호출이 되고, 서블릿이 서비스 하기 위해 필요한 초기화 작업을 수행한다.
- service() : init() 메서드가 service() 메서드를 호출한다. 사용자의 요청에 따라 스레드 단위로 실행되는 메소드이며,
  여러번 실행된다. 각각의 service() 메서드를 통해서 doGet(), doPost() 메서드가 호출된다.
  파라미터니 HttpServletRequest 객체와 HttpServletResponse 객체를 통해 사용자의 요청을 처리한다.
- destroy() : 서블릿이 종료 요청이 오면 한 번만 호출되는 메서드로, 서블릿이 종료됨녀서 정리할 작업이 있으면 destroy() 메서드를 오버라이딩하여 구현한다.

## Servlet 동작 과정

- 클라이언트가 요청을 하면 요청하는 서블릿이 메모리에 로딩되어있는지 확인한다.
- 최초의 요청이면 init() 메소드를 호출하여 요청하는 클래스의 인스턴스(객체)를 메모리에 로딩한다.
- 이후 doGet()이나 doPost() 메서드를 호출하여 서비스를 한다.
- 클라이언트가 다시 동일한 서블릿을 요청하면 톰캣은 요청하는 서블릿이 메모리에 로딩되어있는지 확인한다.
- 이번에는 메모리에 로딩이 되어있는 것이 확인되므로 바로 doGet()이나 doPost 메서드를 호출한다.

## Servlet 방식

- 웹 개발을 위한 표준이 되는 클래스를 말한다.
- 웹 브라우저의 요청을 스레드 방식으로 처리하는 기술을 말한다.
- 서버 쪽에서 실행되면서 클라이언트의 요청에 따라 동적으로 서비스를 제공하는 자바 클래스이다.
- 처리해야 할 일들을 기술하는 곳이다.
- 서블릿은 일반 자바 프로그램과 다르게 독자적으로 실행되지 못하고 톰캣과 같은 서버에서 실행된다.
- 서블릿의 특징
  - 서버쪽에서 실행되면서 기능을 수행한다.
  - 기존의 정적인 웹 프로그램의 문제점을 보오나하여 동적인 여러가지 기능을 제공한다.
  - 스레드 방식으로 실행된다(중요)
  - 클라이언트의 요구를 처리하는 기능을 최초 한 번만 메모리로 로딩한다.
  - 클라이언트가 동일한 기능을 요구하면 기존에 사용한 기능을 재사용한다.
  - 자바로 만들어져서 자바의 특징(OOP)을 가지고 있다.
  - 보안 기능을 적용하기 쉽다.
  - 웹 브라우저에서 요청 시 기능을 수행한다.

## 즉 서블릿은

1.  클라이언트로부터 요청을 받는다.
2.  DB연동과 같은 비지니스 로직을 수행한다.
3.  처리된 결과를 클라이언트에게 돌려준다(응답)

    세 가지의 기능을 수행한다고 볼 수 있다.

# HTML의 form 태그로 Servlet 사용해보기

form 태그는 입력한 데이터의 값을 가지고 action 속성에 입력된 값으로 등록된 servlet 에 접근할 수 있다.
action 속성에 입력한 value 값으로 매핑되어있는 servlet으로 request를 보내면 서버에서 메소드를 실행하고
메소드에 맞게 response를 하여 클라이언트 측에 정보를 전달하는 방식이다.

servlet class를 생성하게 되면 doPost() 메소드와 doGet() 메소드가 있다. 두 메소드 모두 입력받은 정보를 가지고
메소드를 실행한다는 점은 동일하지만, 차이점이 있다.

doGet() 메소드는 form태그를 통해 받아올 수 있는 데이터값이 255자로 제한되며, url 뒤쪽에 받아온 데이터 값들이 출력되기 때문에
보안 면에서 불리하다. 대신 서버에서 처리하는 과정이 빠르다는 장점이 있다.

doPost() 메소드는 받아올 수 있는 데이터값이 무제한이며, 받아온 데이터를 숨겨서 작업을 처리하기 때문에 보안면에서 우수하다.
하지만 받아오는 데이터가 길어질 수록 doGet() 메소드보다 성능 면에서 떨어진다.

servlet을 등록하는 방식은 annotation과 xml 방식이 있다. annotation 방식은 Servlet Class의 annotation인 @WebServlet("value")에
value 키워드를 입력하면 form 태그 action 속성에 해당 value를 입력하면 해당 servlet이 실행되게끔 하도록 servlet class 매핑하여 사용한다.

xml 방식은 WebContent 폴더 내에있는 WEB-INF 폴더에 있는 Web.xml 파일에 servlet을 등록하여 사용한다.
servlet 태그를 생성하고, 태그 안에 servlet-name 태그를 만들어서 태그의 이름을 지정하고 servlet-class 태그를 통해 servlet이 위치한 경로를 지정한다.
경로는 (패키지이름.servlet Class 이름)으로 작성하면 된다.

annotation 방식에서 @WebServlet("value")을 사용하여 매핑을 했던 것 처럼, xml 방식도 servlet-mapping 태그를 사용하여 servlet을 실행시킬 키워드로 매핑해주어야한다.
