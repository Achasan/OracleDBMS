# JSP 20211015 TIL

<% %> 태그를 이용하여 JSP 파일 내에 자바코드로 로직을 구현하고, 출력하는 부분을 배우고,
forward에 대해서 중점적으로 배웠다.

# <%> 태그, JSP 파일에서 자바코드 실행

JSP가 HTML보다 더 나은 장점을 가진 이유는 HTML과 자바코드를 동시에 작성할 수 있기 때문이다.
<%> 태그를 사용하면 안에 자바코드를 작성할 수 있다. 변수 선언은 물론, 자바에서 사용했던 API까지
사용이 가능하다는 장점이 있다.

<%>는 자바코드를 통해 로직을 구현할 수만 있는 태그이다. 만약 자바코드를 통해 구현한 로직을 가지고
얻은 데이터를 출력하기 위해서는 <%= %> %옆에 '='을 사용하여 안에 변수나 문자열을 집어넣으면
출력이 가능하다.

메서드를 선언하기 위해서는 <%! %>를 통해 안에 메서드 선언과 실행부를 작성하면 된다.

JSP 페이지의 맨 위에는 <%@ %> 태그 안에 JSP파일이 가지고 있는 설정과 정보들이 담긴 속성들이 있다.
여기서 isErrorPage 속성과 errorPage 속성을 통해 500 에러나 404 에러가 발생했을 경우 호출할
에러페이지를 지정해줄 수 있다.

Servlet을 통해 request 객체에 담겨져 있는 데이터를 가공하거나, 로직을 통해 DB에 접근하는 등의
작업을 수행했었다. <% %> 태그안에서는 기본적인 Servlet 객체들을 제공하기 때문에 Servlet을 거치지않고
비즈니스 모델을 구현하는 것이 가능하다.

# JSP 페이지 이동 : forward, redirect

    - 웹 어플리케이션은 여러 기능을 합쳐 하나의 프로그램을 실행하는 구조로 되어있다.
    	회원관리 기능, 게시판 관리 기능, 주문 관리 등에 대해 각각의 서블릿이 기능을 수행하게 되어있다.

    - 이 때 프로그램을 실행하다 보면 서블릿끼리 또는 서블릿과 JSP를 연동해서 작업을 해야 하는 경우가 생길 수 밖에 없다.
    	예를 든다면 쇼핑몰의 경우 상품 관리 서블릿과 조회된 상품을 화면에 표시하는 JSP는 각각 따로 존재하게 되어있다.
    	따라서 사용자가 상품 조회를 요청하면 상품 관리 서블릿은 데이터베이스에서 상품 정보를 조회한 후 다시 JSP에게 해당 상품 정보를 전달하여 상품 정보를 표시해야한다.
    	이러한 페이지 이동은 필수적이다.
    		* 요청에 대한 추가 작업을 다른 서블릿에게 수행하게 한다.
    		* 요청에 포함된 정보를 다른 서블릿이나 JSP와 공유할 수 있다.
    		* 요청에 정보를 포함시켜 다른 서블릿에게 전달할 수 있다.
    		* 모델 2 개발 시 서블릿에서 JSP 페이지로 데이터를 전달하는데 사용되어진다.(매우중요)

    1. forward 방식
    	- request의 영역(scope)에 담기 값이 유효하다.
    	- 이동된 화면이 url에 안 보인다.(사용자는 이동했는지 알 수 없다.)
    	- 서블릿이 직접 요청하는 방식이다.
    	- 주로 키 값을 넘겨줄 떄 사용한다.(중요)
    	- RequestDispacher 객체를 이용한다 -> forward() 메서드를 이용
    		형식)
    				RequestDispacher rd = request.getReauestDispacher("이동위치");
    				rd.forward(request, response);

    2. redirect 방식
    	- 클라이언트가 새로 페이지를 요청하는 것과 같은 방식으로 페이지가 이동이 된다.
    	- 웹 브라우저에 재요청하는 방식이다.
    	- 일반적으로 변수 값을 넘겨줄 떄 유용하다.(중요)
    	- request, response 값이 유효하지 않다.( 새로 만들어짐)
    	- 이동된 url이 화면에 나타난다.
    		형식)
    			response.sendRedirect("이동위치");

# 에러페이지 처리하기

에러페이지를 처리하는 방법은 생각보다 간단하다. JSP 페이지의 맨 위에있는 페이지 설정 태그에 isErrorPage="true" errorPage="error.jsp"를 넣어주면 된다.
isErrorPage는 해당 웹페이지가 에러페이지인지를 확인하는 속성이다. 동적으로 작동하는 코드가 실행되다가 예외를 발견하게되면 isErrorPage가 true가 된다.

isErrorPage가 true 일 때 이동할 에러페이지를 errorPage 속성 안에 넣어주면 된다.
하지만 이 방법은 하나의 에러페이지만 띄울 수 있어서 선호하는 방법은 아니다. 나중에 xml 방식을 통해 404에러, 500에러 등 뜨는 에러마다 보낼 수 있는 에러 페이지를 다르게 설정할 수 있는 방법도 있다.
