# SQL 복수행 함수(그룹함수)

    단일행 함수는 하나의 데이터가 가공되는 방식이었다면, 복수행함수는 한꺼번에 여러 건의 데이터가 함수로 입력되는
    방식이다. 사용법은 일반적인 함수와 매우 비슷하다. 다만 주의해야할 점은 null값을 각 함수마다 어떻게 취급하는지를
    알아야 한다는 점이다. 주로 사용되는 복수행 함수들을 알아보자.

- COUNT() : 입력되는 데이터의 갯수를 출력한다.
  SUM() : 입력된 데이터의 합계 값을 출력한다.
  AVG() : 입력된 데이터의 평균값을 출력한다. NULL 값은 제외하기 때문에 NVL()함수로 치환하는 것이 좋다.

  MAX() : 입력된 데이터 중 가장 큰 값을 출력한다.
  MIN() : 입력된 데이터 중 가장 작은 값을 출력한다.
  ※ MAX() 함수와 MIN() 함수는 정렬한 후에 가장 큰 값/작은 값을 출력하기 때문에 성능이 좋지 않다.
     추후에 INDEX를 사용하는 것을 추천한다.

  STDDEV() : 입력된 값중 표준편차를 출력한다.
  VARIANCE() : 입력된 값 중 분산값을 출력한다.

## GROUP BY : 특정 조건으로 세부적인 그룹화하기

    EMP 테이블에서 SAL 컬럼의 평균을 구한다고 해보자. SAL의 평균은 단순히 컬럼에 있는 SAL 데이터 값들을 
    평균으로 나누기 때문에 하나의 데이터만 출력될 것이다.
    하지만 직업별로 SAL 평균을 보고싶을 때는 어떻게 해야할까?

    SELECT JOB, TRUNC(AVG(NVL(SAL, 0)), 0) FROM EMP GROUP BY JOB;
    다음의 문장을 작성하면 직업별로 급여평균을 출력할 수 있다. 뒤에 GROUP BY 키워드가 보이는데, 이는 JOB의
    데이터를 그루핑하여 출력하라는 의미가 된다. 따라서 직업 별로 SAL의 평균값이 출력되게 된다.

    조금 더 응용해보자,
    SELECT JOB, TRUNC(AVG(NVL(SAL, 0)), 0) 
    FROM EMP 
    GROUP BY DEPTNO, JOB;
    이번엔 GROUP BY가 두 번 사용되었다. 먼저 부서별로 그룹핑한 다음, 부서 별로 존재하는 각 직업 별로 두 번 그룹핑하여
    데이터를 출력하라는 의미이다.
    예를 들어, 부서번호가 10, 20, 30으로 3개가 있고, 직업이 5개가 있다고 할 때, 부서번호가 10인 그룹의 직업 별 평균,
    20인 그룹의 직업 별 평균, 30인 그룹의 직업 별 평균을 출력하라는 뜻이 된다.
    다소 헷갈릴 수 있으니 제대로 이해하고 넘어가야 한다.
    그룹핑을 했을 경우에는 데이터가 정렬이 안되게 뒤죽박죽 섞여있으므로 ORDER BY를 통해 정렬해 주는 것이 보기 좋다.

    GROUP BY를 사용하기 위해서는 두 가지의 조건이 있다.
    1. SELECT 절에 사용된 컬럼이나 포현식은 반드시 GROUP BY 절에 사용되어야 한다. 안그러면 에러가 난다.
      (GROUP BY에 사용된 컬럼은 SELECT에 반드시 있어야할 필요는 없다.)

    2. GROUP BY절에는 반드시 컬럼명이 사용되어야 하고, 컬럼 별칭은 사용될 수 없다.


## HAVING 절의 사용

    WHERE 문에 그룹함수를 사용하여 조건식을 작성할 수 있을까? 답은 NO다. WHERE문에서는 그룹 함수를
    비교조건으로 사용할 수 없다. 대신 HAVING문을 사용하면 해결이 가능하다.
    SELECT DEPTNO, AVG(NVL(SAL,0))    - 부서번호, 급여평균 출력
    FROM EMP                          - EMP 테이블에서
    WHERE DEPTNO > 10                 - DEPTNO가 20, 30인 경우
    GROUP BY DEPTNO                   - 부서번호 별로 평균 출력
    HAVING AVG(NVL(SAL, 0)) > 2000;   - 급여평균이 2000 이상인 경우 출력(그룹함수는 HAVING문으로 조건을 줄 수 있다.)
    
    WHERE문에 그룹함수를 사용할 수 없다는 사실이 중요하다.

    
    